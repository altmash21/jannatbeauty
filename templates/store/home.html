{% extends "base.html" %}
{% load static %}
{% block title %}Jannat Beauty{% endblock %}
{% block extra_css %}
<style>
    /* Responsive font size for collection section */
    @media (max-width: 768px) {
      .collection .title-xlarge {
        font-size: 2rem !important;
        margin-bottom: 0.5rem !important;
      }
      .collection-content h3.element-title {
        font-size: 1.2rem !important;
        margin-bottom: 0.5rem !important;
      }
      .collection-content p {
        font-size: 0.95rem !important;
        line-height: 1.5 !important;
      }
      .collection-content {
        padding: 1.2rem !important;
        margin: 0 !important;
      }
    }
  @media (max-width: 768px) {
    .hero-section {
      max-height: 30vh !important;
      height: 30vh !important;
      overflow: hidden;
    }
    .video-content .video-bg {
      height: 220px !important;
      min-height: 220px !important;
      max-height: 300px !important;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .video-content .video-image {
      height: 100% !important;
      object-fit: cover !important;
    }
  }

  /* Mobile font size adjustments for hero section */
  @media (max-width: 768px) {
    .hero-heading {
      font-size: 1.3rem !important;
      margin-bottom: 0.75rem !important;
    }
    
    .hero-subtext {
      font-size: 0.8rem !important;
      margin-bottom: 0.75rem !important;
      line-height: 1.4 !important;
    }
    
    .hero-content .btn {
      font-size: 0.75rem !important;
      padding: 0.5rem 1.2rem !important;
    }
    
    /* Add spacing between sections */
    section {
      margin-bottom: 2rem !important;
    }
    
    .hero-section {
      margin-bottom: 1.5rem !important;
    }
  }

  /* Mobile font size and spacing adjustments for features section */
  @media (max-width: 768px) {
    .features {
      margin-bottom: 1rem !important;
      padding-top: 0.5rem !important;
      padding-bottom: 0.5rem !important;
    }
    .features .py-5 {
      padding-top: 0.5rem !important;
      padding-bottom: 0.5rem !important;
    }
    .features .element-title {
      font-size: 0.95rem !important;
      margin-top: 0.5rem !important;
      margin-bottom: 0.5rem !important;
    }
    .features p {
      font-size: 0.8rem !important;
      line-height: 1.4 !important;
      margin-bottom: 0.5rem !important;
    }
    .features .py-5 > svg {
      margin-bottom: 0.5rem !important;
    }
  }

  /* Mobile categories - swipeable 2.5 cards */
  @media (max-width: 768px) {
    .categories .row {
      display: flex !important;
      flex-wrap: nowrap !important;
      overflow-x: auto !important;
      scroll-snap-type: x mandatory !important;
      -webkit-overflow-scrolling: touch !important;
      gap: 0.5rem !important;
      padding-bottom: 1rem !important;
    }
    
    .categories .row > div {
      flex: 0 0 40% !important;
      max-width: 40% !important;
      scroll-snap-align: start !important;
    }
    
    .category-content .product-button a {
      font-size: 0.7rem !important;
      padding: 0.4rem 0.8rem !important;
    }
  }

  /* Ensure section headings and links are perfectly aligned */
  .product-carousel .d-flex.justify-content-between h5 {
    margin-bottom: 0 !important;
    line-height: 1.2;
    display: flex;
    align-items: center;
  }
  
  .product-carousel .btn-link {
    line-height: 1.2;
    display: flex;
    align-items: center;
    text-decoration: none;
    color: #6c757d;
    font-size: 0.9rem;
    transition: color 0.2s ease;
  }
  
  .product-carousel .btn-link:hover {
    color: #495057;
    text-decoration: underline;
  }
</style>
{% endblock %}
{% block content %}
  <section id="hero" class="hero-section position-relative overflow-hidden">
    <!-- Video Background -->
    <video class="hero-video position-absolute top-0 start-0 w-100 h-100 object-fit-cover" autoplay muted loop>
      <source src="{% static 'videos/background3.mp4' %}" type="video/mp4">
      <source src="{% static 'videos/hero-video.webm' %}" type="video/webm">
      <!-- Fallback for browsers that don't support video -->
      Your browser does not support the video tag.
    </video>

    <!-- Overlay -->
    <div class="hero-overlay position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-50"></div>

    <!-- Content -->
    <div class="hero-content position-relative d-flex align-items-center justify-content-center text-center text-white">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <h1 class="hero-heading display-1 fw-bold mb-4" data-aos="fade-up">
              Jannat — Authentic Islamic Goods
            </h1>
            <p class="hero-subtext fs-4 mb-4" data-aos="fade-up" data-aos-delay="300">
              Beautiful Qur'ans, prayer essentials, modest fashion and meaningful gifts — carefully curated for your family.
            </p>
            <a href="{% url 'store:product_list' %}" class="btn btn-light btn-lg px-5rem py-3rem text-uppercase" data-aos="fade-up" data-aos-delay="600" style="background-color: #06402B; border-color: #06402B; color: white;">
              Explore Collections
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="categories overflow-hidden" style="margin-top: 3rem;">
    <div class="container">
      <div class="open-up" data-aos="zoom-out">
        <div class="row">
          <div class="col-lg-3 col-md-6 col-6 mb-4">
            <div class="cat-item image-zoom-effect">
              <div class="image-holder">
                <a href="index.html">
                  <video class="w-100" autoplay muted loop playsinline style="aspect-ratio: 1 / 1; object-fit: cover;">
                    <source src="{% static 'videos/quran-loop.mp4' %}" type="video/mp4">
                  </video>
                </a>
              </div>
              <div class="category-content">
                <div class="product-button">
                  <a href="{% url 'store:product_list' %}" style="background-color: white; color: black; border: none;font-weight: 400; texts">QURAN</a>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-6 mb-4">
            <div class="cat-item image-zoom-effect">
              <div class="image-holder">
                <a href="index.html">
                  <video class="w-100" autoplay muted loop playsinline style="aspect-ratio: 1 / 1; object-fit: cover;">
                    <source src="{% static 'videos/quranbg.mp4'%}" type="video/mp4">
                  </video>
                </a>
              </div>
              <div class="category-content">
                <div class="product-button">
                  <a href="{% url 'store:product_list' %}"style="background-color: white; color: black; border: none; font-weight: 400;">FOR KIDS</a>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-6 mb-4">
            <div class="cat-item image-zoom-effect">
              <div class="image-holder">
                <a href="index.html">
                  <video class="w-100" autoplay muted loop playsinline style="aspect-ratio: 1 / 1; object-fit: cover;">
                    <source src="{% static 'videos/gifts-loop.mp4'%}" type="video/mp4">
                  </video>
                </a>
              </div>
              <div class="category-content">
                <div class="product-button">
                  <a href="{% url 'store:product_list' %}" style="background-color: white; color: black; border: none; padding: 12px 24px; font-weight: 400;">ACCESSORIES</a>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-6 mb-4">
            <div class="cat-item image-zoom-effect">
              <div class="image-holder">
                <a href="index.html">
                  <video class="w-100" autoplay muted loop playsinline style="aspect-ratio: 1 / 1; object-fit: cover;">
                    <source src="{% static 'videos/4th-loop.mp4'%}" type="video/mp4">
                  </video>
                </a>
              </div>
              <div class="category-content">
                <div class="product-button">
                  <a href="{% url 'store:product_list' %}"style="background-colo r: white; color: black; border: none; font-weight: 400;">NEW ARRIVALS</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="features py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-6 text-center" data-aos="fade-in" data-aos-delay="0">
          <div class="py-5">
            <svg width="38" height="38" viewBox="0 0 24 24">
              <use xlink:href="#shopping-bag"></use>
            </svg>
            <h4 class="element-title text-capitalize my-3">Authentic Islamic Products</h4>
            <p>Handpicked Qur'ans, prayer mats, modest apparel, and tasbihs from trusted sellers.</p>
          </div>
        </div>
        <div class="col-md-3 col-6 text-center" data-aos="fade-in" data-aos-delay="300">
          <div class="py-5">
            <svg width="38" height="38" viewBox="0 0 24 24">
              <use xlink:href="#calendar"></use>
            </svg>
            <h4 class="element-title text-capitalize my-3">Fast Local Delivery</h4>
            <p>Next-day delivery in major cities and real-time tracking for every order.</p>
          </div>
        </div>
        <div class="col-md-3 col-6 text-center" data-aos="fade-in" data-aos-delay="600">
          <div class="py-5">
            <svg width="38" height="38" viewBox="0 0 24 24">
              <use xlink:href="#gift"></use>
            </svg>
            <h4 class="element-title text-capitalize my-3">Secure Payments</h4>
            <p>Encrypted checkout and multiple trusted payment methods for safe shopping.</p>
          </div>
        </div>
        <div class="col-md-3 col-6 text-center" data-aos="fade-in" data-aos-delay="900">
          <div class="py-5">
            <svg width="38" height="38" viewBox="0 0 24 24">
              <use xlink:href="#arrow-cycle"></use>
            </svg>
            <h4 class="element-title text-capitalize my-3">Easy Returns </h4>
            <p>3-day returns and 24/7 support to help with orders, sizing, and product questions.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="new-arrival" class="new-arrival product-carousel py-5 position-relative overflow-hidden">
    <div class="container">
      <div class="d-flex flex-wrap justify-content-between align-items-center mt-5 mb-3">
        <h5 class="text-uppercase">Our New Arrivals</h5>
        <a href="{% url 'store:product_list' %}" class="btn-link">View All Products</a>
      </div>
      <div class="swiper product-swiper open-up" data-aos="zoom-out">
        <div class="swiper-wrapper d-flex">
          {% for product in new_arrivals %}
          <div class="swiper-slide">
            <div class="product-item image-zoom-effect link-effect">
              <div class="image-holder position-relative">
                <a href="{{ product.get_absolute_url }}">
                  {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image img-fluid">
                  {% else %}
                    <img src="{% static 'images/product-placeholder.jpg' %}" alt="{{ product.name }}" class="product-image img-fluid">
                  {% endif %}
                </a>
                <a href="{{ product.get_absolute_url }}" class="btn-icon btn-wishlist">
                  <svg width="24" height="24" viewBox="0 0 24 24">
                    <use xlink:href="#heart"></use>
                  </svg>
                </a>
                <div class="product-content">
                  <h6 class="element-title text-uppercase mt-3" >
                    <a href="{{ product.get_absolute_url }}">{{ product.name }}</a>
                  </h6>
                  <div class="d-flex align-items-center mb-2">
                    {% if product.compare_price %}
                      <span class="me-2 text-muted text-decoration-line-through">₹{{ product.compare_price }}</span>
                    {% endif %}
                    <span class="fw-bold text-success">₹{{ product.price }}</span>
                  </div>
                  <div class="d-flex gap-2">
                    <form method="post" action="{% url 'cart:cart_add' product.id %}" class="flex-fill">
                      {% csrf_token %}
                      <input type="hidden" name="quantity" value="1">
                      <button type="submit" class="btn btn-primary w-100" {% if product.stock == 0 %}disabled{% endif %}>{% if product.stock == 0 %}Out of Stock{% else %}Add to Cart{% endif %}</button>
                    </form>
                    <form method="post" action="{% url 'cart:cart_add' product.id %}" class="flex-fill">
                      {% csrf_token %}
                      <input type="hidden" name="quantity" value="1">
                      <input type="hidden" name="buy_now" value="1">
                      <button type="submit" class="btn btn-success w-100" {% if product.stock == 0 %}disabled{% endif %}>{% if product.stock == 0 %}Out of Stock{% else %}Buy Now{% endif %}</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% empty %}
          <div class="swiper-slide">
            <div class="p-4 text-center">No new arrivals at the moment. Check back soon.</div>
          </div>
          {% endfor %}
        </div>
        <div class="swiper-pagination"></div>
      </div>
      <div class="icon-arrow icon-arrow-left"><svg width="50" height="50" viewBox="0 0 24 24">
          <use xlink:href="#arrow-left"></use>
        </svg></div>
      <div class="icon-arrow icon-arrow-right"><svg width="50" height="50" viewBox="0 0 24 24">
          <use xlink:href="#arrow-right"></use>
        </svg></div>
    </div>
  </section>

  <section class="collection bg-light position-relative py-5">
    <div class="container">
      <div class="row">
        <div class="title-xlarge text-uppercase txt-fx domino">Collection</div>
        <div class="collection-item d-flex flex-wrap my-5">
          <div class="col-md-6 column-container">
            <div class="image-holder">
              <img src="{% static 'images/quran.webp' %}" alt="Quran" class="product-image img-fluid rounded shadow w-100 h-100" style="object-fit: cover;">
            </div>
          </div>
          <div class="col-md-6 column-container bg-white">
            <div class="collection-content p-5 m-0 m-md-5">
              <h3 class="element-title text-uppercase">Islamic Essentials for Everyone</h3>
              <p>Discover our handpicked range: Qur'an (Arabic, Hindi, English), Tasbi, Topi, Janamaz, Digital Tasbi, Dua Stickers, Dua Frames, and Dua Books. Perfect for daily worship, gifting, and bringing barakah to your home. Shop authentic Islamic products trusted by families across India.</p>
              <a href="{% url 'store:product_list' %}" class="btn btn-dark text-uppercase mt-3">Shop All Products</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="best-sellers" class="best-sellers product-carousel py-5 position-relative overflow-hidden">
    <div class="container">
      <div class="d-flex flex-wrap justify-content-between align-items-center mt-5 mb-3">
        <h5 class="text-uppercase">Best Selling Items</h5>
        <a href="{% url 'store:product_list' %}" class="btn-link">View All Products</a>
      </div>
      <div class="swiper product-swiper open-up" data-aos="zoom-out">
        <div class="swiper-wrapper d-flex">
          {% for product in best_selling_products %}
          <div class="swiper-slide">
            <div class="product-item image-zoom-effect link-effect">
              <div class="image-holder position-relative">
                <a href="{{ product.get_absolute_url }}">
                  {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image img-fluid">
                  {% else %}
                    <img src="{% static 'images/product-placeholder.jpg' %}" alt="{{ product.name }}" class="product-image img-fluid">
                  {% endif %}
                </a>
                <a href="{{ product.get_absolute_url }}" class="btn-icon btn-wishlist">
                  <svg width="24" height="24" viewBox="0 0 24 24">
                    <use xlink:href="#heart"></use>
                  </svg>
                </a>
                <div class="product-content">
                  <h6 class="element-title text-uppercase mt-3">
                    <a href="{{ product.get_absolute_url }}">{{ product.name }}</a>
                  </h6>
                  <div class="d-flex align-items-center mb-2">
                    {% if product.compare_price %}
                      <span class="me-2 text-muted text-decoration-line-through">₹{{ product.compare_price }}</span>
                    {% endif %}
                    <span class="fw-bold text-success">₹{{ product.price }}</span>
                  </div>
                  <div class="d-flex gap-2">
                    <form method="post" action="{% url 'cart:cart_add' product.id %}" class="flex-fill">
                      {% csrf_token %}
                      <input type="hidden" name="quantity" value="1">
                      <button type="submit" class="btn btn-primary w-100" {% if product.stock == 0 %}disabled{% endif %}>{% if product.stock == 0 %}Out of Stock{% else %}Add to Cart{% endif %}</button>
                    </form>
                    <form method="post" action="{% url 'cart:cart_add' product.id %}" class="flex-fill">
                      {% csrf_token %}
                      <input type="hidden" name="quantity" value="1">
                      <input type="hidden" name="buy_now" value="1">
                      <button type="submit" class="btn btn-success w-100" {% if product.stock == 0 %}disabled{% endif %}>{% if product.stock == 0 %}Out of Stock{% else %}Buy Now{% endif %}</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% empty %}
          <div class="swiper-slide">
            <div class="p-4 text-center">No best sellers at the moment. Check back soon.</div>
          </div>
          {% endfor %}
        </div>
        <div class="swiper-pagination"></div>
      </div>
      <div class="icon-arrow icon-arrow-left"><svg width="50" height="50" viewBox="0 0 24 24">
          <use xlink:href="#arrow-left"></use>
        </svg></div>
      <div class="icon-arrow icon-arrow-right"><svg width="50" height="50" viewBox="0 0 24 24">
          <use xlink:href="#arrow-right"></use>
        </svg></div>
    </div>
  </section>

  <section class="video py-5 overflow-hidden">
    <div class="container-fluid">
      <div class="row">
        <div class="video-content open-up" data-aos="zoom-out">
          <div class="video-bg">
            <img src="{% static 'images/bannerfinal.webp' %}" alt="Islamic Gathering" class="video-image img-fluid rounded shadow">
          </div>
          <div class="video-player">
            {% comment %} <a class="youtube" href="https://www.youtube.com/embed/pjtsGzQjFM4">
              <svg width="24" height="24" viewBox="0 0 24 24">
                <use xlink:href="#play"></use>
              </svg>
              <img src="{% static 'images/text-pattern.png' %}" alt="Islamic Pattern" class="text-rotate">
            </a> {% endcomment %}
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="testimonials py-5 bg-light">
    <div class="section-header text-center mt-5">
      <h3 class="section-title">WHAT OUR CUSTOMERS SAY</h3>
    </div>
    <div class="swiper testimonial-swiper overflow-hidden my-5">
      <div class="swiper-wrapper d-flex">
        <div class="swiper-slide">
          <div class="testimonial-item text-center">
            <blockquote>
              <p>“Beautiful Quran, fast delivery, and excellent quality. Jannat Beauty truly cares about its customers.”</p>
              <div class="review-title text-uppercase">JANNATBEAUTY.IN CUSTOMER</div>
            </blockquote>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="testimonial-item text-center">
            <blockquote>
              <p>“The prayer mat and tasbih I ordered were perfect for gifting. Highly recommend Jannat Beauty!”</p>
              <div class="review-title text-uppercase">Verified Buyer</div>
            </blockquote>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="testimonial-item text-center">
            <blockquote>
              <p>“Quick shipping, secure payment, and wonderful products. Will shop again!”</p>
              <div class="review-title text-uppercase">Family Shopper</div>
            </blockquote>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="testimonial-item text-center">
            <blockquote>
              <p>“Jannat Beauty’s customer support is amazing. They helped me choose the right Quran for my parents.”</p>
              <div class="review-title text-uppercase">Satisfied Customer</div>
            </blockquote>
          </div>
        </div>
      </div>
    </div>
    <div class="testimonial-swiper-pagination d-flex justify-content-center mb-5"></div>
  </section>

  <section id="related-products" class="related-products product-carousel py-5 position-relative overflow-hidden">
    <div class="container">
      <div class="d-flex flex-wrap justify-content-between align-items-center mt-5 mb-3">
        <h5 class="text-uppercase">You May Also Like</h5>
        <a href="{% url 'store:product_list' %}" class="btn-link">View All Products</a>
      </div>
      <div class="swiper product-swiper open-up" data-aos="zoom-out">
        <div class="swiper-wrapper d-flex">
          {% for product in featured_products %}
          <div class="swiper-slide">
            <div class="product-item image-zoom-effect link-effect">
              <div class="image-holder position-relative">
                <a href="{{ product.get_absolute_url }}">
                  {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image img-fluid">
                  {% else %}
                    <img src="{% static 'images/product-placeholder.jpg' %}" alt="{{ product.name }}" class="product-image img-fluid">
                  {% endif %}
                </a>
                <a href="{{ product.get_absolute_url }}" class="btn-icon btn-wishlist">
                  <svg width="24" height="24" viewBox="0 0 24 24">
                    <use xlink:href="#heart"></use>
                  </svg>
                </a>
                <div class="product-content">
                  <h6 class="element-title text-uppercase mt-3">
                    <a href="{{ product.get_absolute_url }}">{{ product.name }}</a>
                  </h6>
                  <div class="d-flex align-items-center mb-2">
                    {% if product.compare_price %}
                      <span class="me-2 text-muted text-decoration-line-through">₹{{ product.compare_price }}</span>
                    {% endif %}
                    <span class="fw-bold text-success">₹{{ product.price }}</span>
                  </div>
                  <div class="d-flex gap-2">
                    <form method="post" action="{% url 'cart:cart_add' product.id %}" class="flex-fill">
                      {% csrf_token %}
                      <input type="hidden" name="quantity" value="1">
                      <button type="submit" class="btn btn-primary w-100" {% if product.stock == 0 %}disabled{% endif %}>{% if product.stock == 0 %}Out of Stock{% else %}Add to Cart{% endif %}</button>
                    </form>
                    <form method="post" action="{% url 'cart:cart_add' product.id %}" class="flex-fill">
                      {% csrf_token %}
                      <input type="hidden" name="quantity" value="1">
                      <input type="hidden" name="buy_now" value="1">
                      <button type="submit" class="btn btn-success w-100" {% if product.stock == 0 %}disabled{% endif %}>{% if product.stock == 0 %}Out of Stock{% else %}Buy Now{% endif %}</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% empty %}
          <div class="swiper-slide">
            <div class="p-4 text-center">No recommendations at the moment. Check back soon.</div>
          </div>
          {% endfor %}
        </div>
        <div class="swiper-pagination"></div>
      </div>
      <div class="icon-arrow icon-arrow-left"><svg width="50" height="50" viewBox="0 0 24 24">
          <use xlink:href="#arrow-left"></use>
        </svg></div>
      <div class="icon-arrow icon-arrow-right"><svg width="50" height="50" viewBox="0 0 24 24">
          <use xlink:href="#arrow-right"></use>
        </svg></div>
    </div>
  </section>

  <section class="blog py-5">
    <div class="container">
      <div class="d-flex flex-wrap justify-content-between align-items-center mt-5 mb-3">
        <h4 class="text-uppercase">Read Blog Posts</h4>
        <a href="{% url 'blog:blog_list' %}" class="btn-link">View All</a>
      </div>
      <div class="row">
        {% for post in blog_posts %}
        <div class="col-md-4 mb-4">
          <article class="post-item">
            <div class="post-image">
              {% if post.image %}
                <a href="{{ post.get_absolute_url }}">
                  <img src="{{ post.image.url }}" alt="{{ post.title }}" class="post-grid-image img-fluid">
                </a>
              {% else %}
                <a href="{{ post.get_absolute_url }}">
                  <img src="{% static 'images/post-image1.jpg' %}" alt="image" class="post-grid-image img-fluid">
                </a>
              {% endif %}
            </div>
            <div class="post-content d-flex flex-wrap gap-2 my-3">
              <div class="post-meta text-uppercase fs-6 text-secondary">
                <span class="post-category">{{ post.category }} /</span>
                <span class="meta-day"> {{ post.created_at|date:"M d, Y" }}</span>
              </div>
              <h5 class="post-title text-uppercase">
                <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
              </h5>
              <p>{{ post.excerpt|truncatewords:20 }}</p>
            </div>
          </article>
        </div>
        {% empty %}
        <div class="col-12">
          <div class="alert alert-info text-center">
            No blog posts available at the moment. Check back soon!
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>

  {% comment %} <section class="logo-bar py-5 my-5">
    <div class="container">
      <div class="row">
        <div class="logo-content d-flex flex-wrap justify-content-between">
          <img src="images/logo1.png" alt="logo" class="logo-image img-fluid">
          <img src="images/logo2.png" alt="logo" class="logo-image img-fluid">
          <img src="images/logo3.png" alt="logo" class="logo-image img-fluid">
          <img src="images/logo4.png" alt="logo" class="logo-image img-fluid">
          <img src="images/logo5.png" alt="logo" class="logo-image img-fluid">
        </div>
      </div>
    </div>
  </section> {% endcomment %}

  <section class="newsletter bg-light" style="background: url({% static 'images/banner2.webp' %}) no-repeat center center; background-size: cover;">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-8 py-5 my-5">
          <div class="subscribe-header text-center pb-3">
            <h3 class="section-title text-uppercase">Sign Up for our newsletter</h3>
          </div>
          <form id="form" class="d-flex flex-wrap gap-2">
            <input type="text" name="email" placeholder="Your Email Addresss" class="form-control form-control-lg">
            <button class="btn btn-dark btn-lg text-uppercase w-100">Sign Up</button>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- Discount Popup Modal -->
  <div class="modal fade" id="discountModal" tabindex="-1" aria-labelledby="discountModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg" style="border-radius: 15px; overflow: hidden;">
        <div class="modal-header bg-gradient text-white text-center border-0" style="background: linear-gradient(135deg, #06402B, #0a5d3a);">
          <div class="w-100">
            <h4 class="modal-title fw-bold mb-1" id="discountModalLabel">
              <i class="fas fa-gift me-2"></i>Get 10% OFF!
            </h4>
            <p class="mb-0 small">Limited time offer for new customers</p>
          </div>
        </div>
        <div class="modal-body p-4">
          <div class="text-center mb-4">
            <div class="discount-badge d-inline-block px-4 py-2 rounded-pill mb-3" style="background: #06402B; color: white; font-size: 1.2rem; font-weight: bold;">
              Save 10%
            </div>
            <p class="text-muted mb-0">Enter your details below to claim your discount</p>
          </div>
          
          <form id="discountForm" class="needs-validation" novalidate>
            {% csrf_token %}
            <div class="row g-3">
              <div class="col-md-6">
                <label for="customerName" class="form-label fw-semibold">Full Name</label>
                <input type="text" class="form-control form-control-lg" id="customerName" name="name" placeholder="Enter your name" required style="border-radius: 10px;">
                <div class="invalid-feedback">Please provide your name.</div>
              </div>
              <div class="col-md-6">
                <label for="customerPhone" class="form-label fw-semibold">Phone Number</label>
                <input type="tel" class="form-control form-control-lg" id="customerPhone" name="phone" placeholder="Enter phone number" required pattern="[0-9]{10}" style="border-radius: 10px;">
                <div class="invalid-feedback">Please provide a valid 10-digit phone number.</div>
              </div>
            </div>
            
            <div class="d-grid gap-2 mt-4">
              <button type="submit" class="btn btn-lg fw-semibold text-white" style="background: #06402B; border: none; border-radius: 10px; padding: 12px;">
                <i class="fas fa-tag me-2"></i>Claim My 10% Discount
              </button>
            </div>
          </form>
          
          <!-- Success Message -->
          <div id="successMessage" class="alert alert-success d-none mt-3" style="border-radius: 10px;">
            <div class="d-flex align-items-center">
              <i class="fas fa-check-circle me-2"></i>
              <div>
                <strong>Congratulations!</strong><br>
                <span id="couponCode" class="fw-bold"></span>
                <div class="mt-2">
                  <small>Use this code at checkout to get 10% off on orders above ₹100</small>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Error Message -->
          <div id="errorMessage" class="alert alert-danger d-none mt-3" style="border-radius: 10px;">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span id="errorText"></span>
          </div>
        </div>
        <div class="modal-footer border-0 pt-0">
          <button type="button" class="btn btn-link text-muted fw-semibold" data-bs-dismiss="modal" style="text-decoration: none;">
            <i class="fas fa-times me-1"></i>Skip for now
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="{% static 'js/buy_now.js' %}"></script>
    <!-- Ensure Bootstrap JS is loaded for modal functionality -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Discount Popup Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Always show popup after 3 seconds on page load
      setTimeout(function() {
        try {
          const discountModal = new bootstrap.Modal(document.getElementById('discountModal'));
          discountModal.show();
        } catch (e) {
          // Fallback: force show modal if Bootstrap JS is not loaded yet
          document.getElementById('discountModal').classList.add('show');
          document.getElementById('discountModal').style.display = 'block';
        }
      }, 3000);
      
      // Handle form submission
      const discountForm = document.getElementById('discountForm');
      const successMessage = document.getElementById('successMessage');
      const errorMessage = document.getElementById('errorMessage');
      const couponCodeSpan = document.getElementById('couponCode');
      const errorText = document.getElementById('errorText');
      
      discountForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Validate form
        if (!discountForm.checkValidity()) {
          e.stopPropagation();
          discountForm.classList.add('was-validated');
          return;
        }
        
        const formData = {
          name: document.getElementById('customerName').value.trim(),
          phone: document.getElementById('customerPhone').value.trim()
        };
        
        // Disable submit button
        const submitBtn = discountForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
        submitBtn.disabled = true;
        
        // Submit to backend
        fetch('{% url "coupons:get_discount_popup" %}', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
          },
          body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // Hide form and show success message
            discountForm.style.display = 'none';
            successMessage.classList.remove('d-none');
            couponCodeSpan.textContent = `Your coupon code: ${data.coupon_code}`;
            
            // Auto close modal after 10 seconds
            setTimeout(function() {
              bootstrap.Modal.getInstance(document.getElementById('discountModal')).hide();
            }, 10000);
          } else {
            errorMessage.classList.remove('d-none');
            errorText.textContent = data.message;
          }
        })
        .catch(error => {
          console.error('Error:', error);
          errorMessage.classList.remove('d-none');
          errorText.textContent = 'Something went wrong. Please try again.';
        })
        .finally(() => {
          // Re-enable submit button
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        });
      });
      // No localStorage logic, always show popup on refresh
    });
    });
  </script>

{% endblock %}