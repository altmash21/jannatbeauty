{% load static %}<div class="page-container">
    <div class="inner-container">
        <div class="deals-section home-section deals-blockbuster">
            <div class="section-title">
                <h2>Blockbuster Deals</h2>
            </div>
            <p class="view-all">View all</p>

            <div class="slider-wrapper">
                <div class="swiper-container">
                    <div class="btn-prev"></div>
                    <div class="btn-next"></div>
                    <div class="swiper-pagination"></div>

                    <div class="swiper-slides">
                        {% for product in latest_products %}
                        <div class="swiper-slide">
                            <div class="product-card">
                                <div class="card-details">
                                    <div class="card-data">
                                        <a href="{{ product.get_absolute_url }}" class="product-link">
                                            <div class="top-section">
                                                <div class="image-wrapper">
                                                    <div class="image-container">
                                                        {% if product.image %}
                                                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                                        {% else %}
                                                        <img src="{% static 'img/placeholder.png' %}" alt="{{ product.name }}">
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                <div class="info-wrapper">
                                                    <div class="title-wrapper">
                                                        <div class="product-title">{{ product.name }}</div>
                                                        <div class="empty-div hidden"></div>
                                                        <div class="product-benefits"><span>{{ product.description|truncatewords:8 }}</span></div>
                                                        <div class="divider"></div>
                                                    </div>
                                                </div>
                                                <div class="rating-wrapper">
                                                    <div class="rating-text">{{ product.get_average_rating }}</div>
                                                    <div class="stars">
                                                        {% for i in "12345"|make_list %}
                                                            {% if forloop.counter <= product.get_average_rating|floatformat:0 %}
                                                                <span class="star filled">★</span>
                                                            {% else %}
                                                                <span class="star empty">★</span>
                                                            {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="price-container">
                                                <div class="price-row">
                                                    <div class="offer-price"><span>${{ product.price }}</span></div>
                                                    {% if product.compare_price %}
                                                    <div class="mrp-price"><span>${{ product.compare_price }}</span></div>
                                                    <div class="discount-tag"><span>{{ product.discount_percentage }}% off</span></div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="placeholder"></div>
                                        </a>
                                        <div class="buttons-wrapper">
                                            <div class="cart-button-wrapper">
                                                <button type="button" class="btn-add-cart" data-product-id="{{ product.id }}">ADD TO CART</button>
                                            </div>
                                            <div class="buy-button-wrapper">
                                                <button type="button" class="btn-buy-now">BUY NOW</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="swiper-slide"><div class="product-card">No products available.</div></div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Blockbuster styles moved to static/css/sections/deals-blockbuster.css -->
<link rel="stylesheet" href="{% static 'css/sections/featured_products.css' %}">

<script>
// Product slider JS scoped to this section
document.addEventListener('DOMContentLoaded', function() {
    const root = document.querySelector('.deals-blockbuster');
    if (!root) return;
    const swiperContainers = root.querySelectorAll('.swiper-container');
    swiperContainers.forEach((container) => {
        const slidesWrapper = container.querySelector('.swiper-slides');
        const slides = container.querySelectorAll('.swiper-slide');
        const prevBtn = container.querySelector('.btn-prev');
        const nextBtn = container.querySelector('.btn-next');
        if (!slidesWrapper || slides.length === 0) return;

        let scrollAmount = 0;
        const slideWidth = slides[0].offsetWidth + 10;
        function getVisibleSlides(){ return Math.floor(slidesWrapper.offsetWidth / slideWidth); }
        function updateButtons(){ const maxScroll = slidesWrapper.scrollWidth - slidesWrapper.offsetWidth; if (prevBtn) { prevBtn.style.opacity = scrollAmount <= 0 ? '0.3' : '1'; prevBtn.style.pointerEvents = scrollAmount <= 0 ? 'none' : 'auto'; } if (nextBtn) { nextBtn.style.opacity = scrollAmount >= maxScroll - 5 ? '0.3' : '1'; nextBtn.style.pointerEvents = scrollAmount >= maxScroll - 5 ? 'none' : 'auto'; } }
        function scrollToPosition(position){ slidesWrapper.scrollTo({ left: position, behavior: 'smooth' }); }
        nextBtn?.addEventListener('click', () => { const visibleSlides = getVisibleSlides(); const maxScroll = slidesWrapper.scrollWidth - slidesWrapper.offsetWidth; scrollAmount = Math.min(scrollAmount + (slideWidth * visibleSlides), maxScroll); scrollToPosition(scrollAmount); updateButtons(); });
        prevBtn?.addEventListener('click', () => { const visibleSlides = getVisibleSlides(); scrollAmount = Math.max(scrollAmount - (slideWidth * visibleSlides), 0); scrollToPosition(scrollAmount); updateButtons(); });
        slidesWrapper.addEventListener('scroll', () => { scrollAmount = slidesWrapper.scrollLeft; updateButtons(); });
        slidesWrapper.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; }, { passive: true });
        slidesWrapper.addEventListener('touchend', (e) => { touchEndX = e.changedTouches[0].screenX; handleSwipe(); }, { passive: true });
        let touchStartX = 0, touchEndX = 0;
        function handleSwipe(){ const swipeThreshold = 50; const diff = touchStartX - touchEndX; if (Math.abs(diff) > swipeThreshold) { if (diff > 0) nextBtn?.click(); else prevBtn?.click(); } }
        window.addEventListener('resize', () => { scrollAmount = slidesWrapper.scrollLeft; updateButtons(); });
        updateButtons();
    });
});
</script>
